%------------------------------------------------------------ 
%
%    Damian Skrzypiec
%    12.09.2017
%
%    This script contains decription of CKES algorithm.
%
%------------------------------------------------------------ 


\textbf{TODO:}
\begin{enumerate}
	\item Define "Feasible split" for chain graphs
	\item Define "Feasible merge" for chain graphs
	\item Provide detailes about implementation of CKES algorithm
\end{enumerate}

Algorithm CKES presented in Algorithm \ref{CKESAlG} was introduced in \cite{CKES} in chapter $4$ in figure $4$.

\begin{algorithm}
	\caption{(CKES) CKES Algorithm} \label{CKESAlG}
	
	\textbf{Input:}	Perfect conditional independence knowledge about $\mathbb{P}$.  \\
	\textbf{Output:} Chain graph $G$

	
	\begin{algorithmic}[1]
		\Procedure{CKESAlgorithm()}{}
			\State $\mc{S} = \emptyset$
	
			\ForAll{chain graph $G$ in equivalence class of $G$} 
				\ForAll{orderder pair of vertex X and Y}
					\If{$X \rightarrow Y$ is in $G$ but $X \bigCI Y \mid \mbox{Bd}_G(Y) \setminus X$}
						\State Remove $X \rightarrow Y$ and go to line $3$; 
					\EndIf

					\If{$X - Y$ is in $G$ but $X \bigCI Y \mid \mbox{Bd}_G(Y) \setminus X$ and $X \bigCI Y \mid \mbox{Bd}_G(X) \setminus Y$}
						\State Remove $X - Y$ and go to line $3$; 
					\EndIf

					\If{$X \rightarrow Y$ is not in $G$ but adding it to $G$ \\ 
						\hskip\algorithmicindent \hskip\algorithmicindent  \hskip\algorithmicindent \hskip\algorithmicindent results 
						in CG and $X \not \bigCI Y \mid \mbox{Bd}_G(Y)$}
						\State Add $X \rightarrow Y$ to $G$ and go to line $3$; 
					\EndIf

					\If{$X - Y$ is not in $G$ but adding it to $G$ \\
						\hskip\algorithmicindent \hskip\algorithmicindent  \hskip\algorithmicindent \hskip\algorithmicindent results 
					in CG and $X \not \bigCI Y \mid \mbox{Bd}_G(Y)$ or 
						$X \not \bigCI Y \mid \mbox{Bd}_G(X)$}
						\State Add $X - Y$ to $G$ and go to line $3$; 
					\EndIf

				\State Move to another chain graph in the same equivalence class of $G$ by performing \\ 
					\hskip\algorithmicindent \hskip\algorithmicindent  \hskip\algorithmicindent  a random number
					of random feasible merges or feasible splits on $G$ \\ 
					\hskip\algorithmicindent \hskip\algorithmicindent  \hskip\algorithmicindent and thereby updating $G$;
				\EndFor
			\EndFor			
		
			\State \textbf{return:} G;
		\EndProcedure
	\end{algorithmic}
\end{algorithm}



